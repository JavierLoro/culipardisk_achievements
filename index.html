<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Club Deportivo Culipardisk</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <h1>üèÜ CULIPARDISK</h1>
        <p class="subtitle">Temporada 2025-2026</p>

        <div id="stats" class="stats"></div>

        <div class="achievements-container">
            <div id="playersList" class="players-list">
                <!-- Se generar√° din√°micamente -->
            </div>
        </div>

        <div id="loading" class="loading">Cargando logros...</div>
        <div id="error" class="error" style="display: none;"></div>
    </div>

    <script>
        // Simulaci√≥n del archivo logros.json para demostraci√≥n
        // En producci√≥n, esto se cargar√° desde un archivo JSON externo
        const logrosData = {
            "logros": [
                {
                    "id": "goleador",
                    "nombre": "Goleador",
                    "tipo": "publico",
                    "imagenBloqueada": "https://via.placeholder.com/100/cccccc/666666?text=üîí",
                    "imagenDesbloqueada": "https://via.placeholder.com/100/FFD700/FFFFFF?text=‚öΩ",
                    "descripcion": "Marca 10 goles en la temporada"
                },
                {
                    "id": "asistente",
                    "nombre": "Asistente Estrella",
                    "tipo": "publico",
                    "imagenBloqueada": "https://via.placeholder.com/100/cccccc/666666?text=üîí",
                    "imagenDesbloqueada": "https://via.placeholder.com/100/4169E1/FFFFFF?text=ü§ù",
                    "descripcion": "Realiza 5 asistencias"
                },
                {
                    "id": "mvp",
                    "nombre": "MVP del Mes",
                    "tipo": "publico",
                    "imagenBloqueada": "https://via.placeholder.com/100/cccccc/666666?text=üîí",
                    "imagenDesbloqueada": "https://via.placeholder.com/100/FF1493/FFFFFF?text=‚≠ê",
                    "descripcion": "Mejor jugador del mes"
                },
                {
                    "id": "invicto",
                    "nombre": "Muro Invencible",
                    "tipo": "publico",
                    "imagenBloqueada": "https://via.placeholder.com/100/cccccc/666666?text=üîí",
                    "imagenDesbloqueada": "https://via.placeholder.com/100/32CD32/FFFFFF?text=üõ°Ô∏è",
                    "descripcion": "Portero con 5 partidos sin recibir goles"
                },
                {
                    "id": "veterano",
                    "nombre": "???",
                    "tipo": "secreto",
                    "imagenBloqueada": "https://via.placeholder.com/100/444444/222222?text=‚ùì",
                    "imagenDesbloqueada": "https://via.placeholder.com/100/8B4513/FFFFFF?text=üéñÔ∏è",
                    "descripcion": "100 partidos con el club"
                },
                {
                    "id": "leyenda",
                    "nombre": "???",
                    "tipo": "secreto",
                    "imagenBloqueada": "https://via.placeholder.com/100/444444/222222?text=‚ùì",
                    "imagenDesbloqueada": "https://via.placeholder.com/100/9400D3/FFFFFF?text=üëë",
                    "descripcion": "Capit√°n durante 3 temporadas consecutivas"
                },
                {
                    "id": "comeback",
                    "nombre": "???",
                    "tipo": "secreto",
                    "imagenBloqueada": "https://via.placeholder.com/100/444444/222222?text=‚ùì",
                    "imagenDesbloqueada": "https://via.placeholder.com/100/FF4500/FFFFFF?text=üî•",
                    "descripcion": "Marca 3 goles en una remontada √©pica"
                },
                {
                    "id": "fairplay",
                    "nombre": "Fair Play",
                    "tipo": "publico",
                    "imagenBloqueada": "https://via.placeholder.com/100/cccccc/666666?text=üîí",
                    "imagenDesbloqueada": "https://via.placeholder.com/100/00CED1/FFFFFF?text=ü§ç",
                    "descripcion": "Temporada sin tarjetas rojas"
                }
            ],
            "jugadores": [
                {
                    "nombre": "Carlos Rodr√≠guez",
                    "logrosDesbloqueados": ["goleador", "mvp", "veterano"]
                },
                {
                    "nombre": "Miguel √Ångel Torres",
                    "logrosDesbloqueados": ["asistente", "fairplay"]
                },
                {
                    "nombre": "Javier Hern√°ndez",
                    "logrosDesbloqueados": ["goleador", "asistente", "mvp", "comeback"]
                },
                {
                    "nombre": "Diego Mart√≠nez",
                    "logrosDesbloqueados": ["invicto", "fairplay", "veterano"]
                },
                {
                    "nombre": "Roberto Silva",
                    "logrosDesbloqueados": ["leyenda", "veterano", "fairplay", "mvp"]
                }
            ]
        };

        class AchievementSystem {
            constructor() {
                this.data = null;
                this.init();
            }

            async init() {
                try {
                    // Para pruebas locales
                    //this.data = logrosData;

                    // Para producci√≥n:
                    const response = await fetch('logros.json');
                    this.data = await response.json();

                    this.render();
                    this.hideLoading();
                    this.renderStats();
                } catch (error) {
                    this.showError('Error al cargar los datos: ' + error.message);
                }
            }

            // Nueva funci√≥n para obtener el logro progresivo m√°s alto de cada grupo
            getHighestProgressiveAchievements(jugador) {
                const progresivos = {};

                // Si no hay logros progresivos en el JSON, retornar vac√≠o
                if (!this.data.logrosProgresivos) {
                    return progresivos;
                }

                // Para cada grupo de logros progresivos
                this.data.logrosProgresivos.forEach(grupo => {
                    let highestLevel = 0;
                    let highestAchievement = null;

                    // Buscar el nivel m√°s alto desbloqueado
                    grupo.niveles.forEach(nivel => {
                        if (jugador.logrosDesbloqueados.includes(nivel.id) && nivel.nivel > highestLevel) {
                            highestLevel = nivel.nivel;
                            highestAchievement = nivel;
                        }
                    });

                    // Si no tiene ninguno desbloqueado, mostrar el nivel 1 bloqueado
                    if (!highestAchievement) {
                        highestAchievement = grupo.niveles[0];
                    }

                    progresivos[grupo.grupo] = {
                        achievement: highestAchievement,
                        unlocked: jugador.logrosDesbloqueados.includes(highestAchievement.id),
                        nextLevel: highestLevel < grupo.niveles.length ? grupo.niveles[highestLevel] : null
                    };
                });

                return progresivos;
            }

            render() {
                const playersList = document.getElementById('playersList');
                let html = '';

                // Crear una copia de jugadores y ordenar por cantidad de logros
                const jugadoresOrdenados = [...this.data.jugadores].sort((a, b) => {
                    return b.logrosDesbloqueados.length - a.logrosDesbloqueados.length;
                });

                jugadoresOrdenados.forEach((jugador, index) => {
                    const animationDelay = index * 0.1;
                    const isLeader = index === 0 && jugador.logrosDesbloqueados.length > 0;

                    html += `
                <div class="player-card ${isLeader ? 'leader' : ''}" style="animation-delay: ${animationDelay}s">
                    <div class="player-header">
                        <div class="player-info">
                            <h3 class="player-name">${jugador.nombre}</h3>
                            ${isLeader ? '<span class="leader-badge">üëë</span>' : ''}
                        </div>
                        <span class="achievement-count">${this.countUniqueAchievements(jugador)}/${this.getTotalUniqueAchievements()}</span>
                    </div>
                    <div class="achievements-grid">
                        ${this.renderPlayerAchievements(jugador)}
                    </div>
                </div>
            `;
                });

                playersList.innerHTML = html;
            }

            // Contar logros √∫nicos (considerando progresivos como uno solo)
            countUniqueAchievements(jugador) {
                let count = 0;

                // Contar logros normales
                this.data.logros.forEach(logro => {
                    if (jugador.logrosDesbloqueados.includes(logro.id)) {
                        count++;
                    }
                });

                // Contar grupos progresivos (cada grupo cuenta como 1)
                if (this.data.logrosProgresivos) {
                    this.data.logrosProgresivos.forEach(grupo => {
                        const tieneAlguno = grupo.niveles.some(nivel =>
                            jugador.logrosDesbloqueados.includes(nivel.id)
                        );
                        if (tieneAlguno) count++;
                    });
                }

                return count;
            }

            // Total de logros √∫nicos posibles
            getTotalUniqueAchievements() {
                let total = this.data.logros.length;
                if (this.data.logrosProgresivos) {
                    total += this.data.logrosProgresivos.length;
                }
                return total;
            }

            renderPlayerAchievements(jugador) {
                let achievementsHTML = '';

                // Renderizar logros normales
                this.data.logros.forEach(logro => {
                    const isUnlocked = jugador.logrosDesbloqueados.includes(logro.id);
                    achievementsHTML += this.renderAchievement(logro, isUnlocked);
                });

                // Renderizar logros progresivos (solo el m√°s alto de cada grupo)
                const progresivos = this.getHighestProgressiveAchievements(jugador);
                Object.values(progresivos).forEach(prog => {
                    achievementsHTML += this.renderProgressiveAchievement(
                        prog.achievement,
                        prog.unlocked,
                        prog.nextLevel
                    );
                });

                return achievementsHTML;
            }

            renderAchievement(logro, isUnlocked) {
                let imgSrc, tooltipText, imgClass, tooltipClass = '';

                if (isUnlocked) {
                    imgSrc = logro.imagenDesbloqueada;

                    if (logro.tipo === 'especial') {
                        imgClass = 'achievement-img special-unlocked';
                        tooltipClass = 'special';
                        tooltipText = `<strong>${logro.nombre}</strong><br>${logro.descripcion}`;
                    } else if (logro.tipo === 'publico') {
                        imgClass = 'achievement-img unlocked';
                        tooltipText = `<strong>${logro.nombre}</strong><br>${logro.descripcion}`;
                    } else { // secreto
                        imgClass = 'achievement-img unlocked';
                        tooltipText = `<strong>${logro.descripcion}</strong>`;
                    }
                } else {
                    imgSrc = logro.imagenBloqueada;

                    if (logro.tipo === 'especial') {
                        imgClass = 'achievement-img special-locked';
                        tooltipClass = 'special';
                        tooltipText = `<strong>${logro.nombre}</strong><br>${logro.descripcion}`;
                    } else if (logro.tipo === 'secreto') {
                        imgClass = 'achievement-img secret-locked';
                        tooltipText = '<strong>Secreto</strong>';
                    } else { // publico
                        imgClass = 'achievement-img locked';
                        tooltipText = `<strong>${logro.nombre}</strong><br>${logro.descripcion}`;
                    }
                }

                return `
            <div class="achievement-cell">
                <img src="${imgSrc}" alt="${logro.tipo === 'secreto' && !isUnlocked ? 'Secreto' : logro.nombre}" class="${imgClass}">
                <div class="tooltip ${tooltipClass}">${tooltipText}</div>
            </div>
        `;
            }

            // Nueva funci√≥n para renderizar logros progresivos
            renderProgressiveAchievement(logro, isUnlocked, nextLevel) {
                let imgSrc, tooltipText, imgClass, tooltipClass = '';

                if (isUnlocked) {
                    imgSrc = logro.imagenDesbloqueada;

                    // A√±adir indicador de nivel
                    const levelIndicator = this.getLevelIndicator(logro.nivel);

                    if (logro.tipo === 'especial') {
                        imgClass = 'achievement-img special-unlocked progressive';
                        tooltipClass = 'special progressive';
                    } else {
                        imgClass = 'achievement-img unlocked progressive';
                        tooltipClass = 'progressive';
                    }

                    tooltipText = `<strong>${logro.nombre} ${levelIndicator}</strong><br>${logro.descripcion}`;

                    // Si hay siguiente nivel, mostrar progreso
                    if (nextLevel) {
                        tooltipText += `<br><em style="color: #ffd700; font-size: 0.9em;">Pr√≥ximo: ${nextLevel.descripcion}</em>`;
                    } else {
                        tooltipText += `<br><em style="color: #4CAF50; font-size: 0.9em;">¬°Nivel m√°ximo alcanzado!</em>`;
                    }
                } else {
                    imgSrc = logro.imagenBloqueada;
                    imgClass = 'achievement-img locked progressive';
                    tooltipClass = 'progressive';
                    tooltipText = `<strong>${logro.nombre}</strong><br>${logro.descripcion}`;
                }

                // A√±adir badge de nivel en la imagen
                const levelBadge = this.getLevelBadge(logro.nivel, isUnlocked);

                return `
            <div class="achievement-cell progressive-cell">
                <div class="achievement-wrapper">
                    <img src="${imgSrc}" alt="${logro.nombre}" class="${imgClass}">
                    ${levelBadge}
                </div>
                <div class="tooltip ${tooltipClass}">${tooltipText}</div>
            </div>
        `;
            }

            getLevelIndicator(level) {
                const indicators = ['', 'ü•â', 'ü•à', 'ü•á', 'üíé'];
                return indicators[level] || '';
            }

            getLevelBadge(level, isUnlocked) {
                if (!isUnlocked) return '';

                const badges = {
                    1: '<span class="level-badge bronze">I</span>',
                    2: '<span class="level-badge silver">II</span>',
                    3: '<span class="level-badge gold">III</span>',
                    4: '<span class="level-badge diamond">IV</span>'
                };

                return badges[level] || '';
            }

            renderStats() {
                const statsDiv = document.getElementById('stats');

                const totalJugadores = this.data.jugadores.length;

                // Contar logros √∫nicos totales
                const totalUniqueAchievements = this.getTotalUniqueAchievements();
                const logrosSecretos = this.data.logros.filter(l => l.tipo === 'secreto').length;
                let publicosDesbloqueados = 0;
                let secretosDesbloqueados = 0;
                // Contar jugadores con al menos un logro
                const jugadoresConLogros = this.data.jugadores.filter(j => j.logrosDesbloqueados.length > 0).length;

                // Calcular estad√≠sticas de progresivos
                let totalProgresivosDesbloqueados = 0;
                let totalProgresivosMaximos = 0;

                if (this.data.logrosProgresivos) {
                    this.data.jugadores.forEach(jugador => {
                        this.data.logrosProgresivos.forEach(grupo => {
                            const niveles = grupo.niveles;
                            let maxNivel = 0;

                            niveles.forEach(nivel => {
                                if (jugador.logrosDesbloqueados.includes(nivel.id) && nivel.nivel > maxNivel) {
                                    maxNivel = nivel.nivel;
                                }
                            });

                            if (maxNivel > 0) {
                                totalProgresivosDesbloqueados++;
                                if (maxNivel === niveles.length) {
                                    totalProgresivosMaximos++;
                                }
                            }
                        });
                    });
                }
                this.data.jugadores.forEach(jugador => {
                    jugador.logrosDesbloqueados.forEach(logroId => {
                        const logro = this.data.logros.find(l => l.id === logroId);
                        if (logro) {
                            if (logro.tipo === 'publico') publicosDesbloqueados++;
                            if (logro.tipo === 'secreto') secretosDesbloqueados++;
                        }
                    });
                });
                // Calcular porcentajes
                const porcentajeProgresivos = this.data.logrosProgresivos ?
                    Math.round((totalProgresivosMaximos / (this.data.logrosProgresivos.length * totalJugadores)) * 100) : 0;


                statsDiv.innerHTML = `
            <div class="stat-card fade-in">
                <div class="stat-number">${jugadoresConLogros}</div>
                <div class="stat-label">Socios temporada</div>
            </div>
            <div class="stat-card fade-in" style="animation-delay: 0.1s;">
                <div class="stat-number">${totalUniqueAchievements}</div>
                <div class="stat-label">Total logros</div>
            </div>
            <div class="stat-card fade-in" style="animation-delay: 0.2s;">
                <div class="stat-number">${totalProgresivosDesbloqueados}</div>
                <div class="stat-label">Progresivos Activos</div>
            </div>
            <div class="stat-card fade-in" style="animation-delay: 0.3s;">
                <div class="stat-number">${porcentajeProgresivos}%</div>
                <div class="stat-label">Niveles M√°ximos</div>
            </div>
        `;
            }

            hideLoading() {
                document.getElementById('loading').style.display = 'none';
            }

            showError(message) {
                document.getElementById('loading').style.display = 'none';
                const errorDiv = document.getElementById('error');
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
            }
        };// Inicializar el sistema cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', () => {
            new AchievementSystem();
        });
    </script>
</body>

</html>